% 状态空间参数
A=[-0.127 0 0 0;...
    0 -0.1512 0 -18.28;...
    0 1.53 0 288;...
    0 0 1 0];
B=[5.77 -5.77;...
    0.51 0.51;...
    -5.20 -5.20;...
    0 0];
C=[1 0 0 0;...
    0 1 0 0;...
    0 0 1 0;...
    0 0 0 1];
D=[0 0;...
    0 0;...
    0 0;...
    0 0];
Q=[2 0 0 0;...
    0 80 0 0;...
    0 0 30 0;...
    0 0 0 20];
R=[0.03 0;...
    0 0.02];

% 论文中给的数据
% 反馈通道系数
K=[6.1034,-33.6929,-25.8861,-184.0693;-6.1034,-33.6929,-25.8861,-184.0693];
% 前向通道增益
G=[6.6315 -46.4681 0 0;-6.6315 -46.4681 0 0];

% 重新计算验证
[K1,S,P] = lqr(A,B,Q,R);
K2 = -inv(R)*B'*S;
K_L=K2(1,:);
K_R=K2(2,:);

G1 = inv(S*B*inv(R)*B'-A')*C'*Q;
G2 = inv(R)*B'*G1;
G_L=G2(1,:);
G_R=G2(2,:);



